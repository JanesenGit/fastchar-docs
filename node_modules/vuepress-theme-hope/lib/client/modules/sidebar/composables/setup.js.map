{"version":3,"file":"setup.js","sourceRoot":"","sources":["../../../../../src/client/modules/sidebar/composables/setup.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,mBAAmB,EAAE,MAAM,cAAc,CAAC;AAEnD,OAAO,EAAE,QAAQ,EAAE,MAAM,EAAE,OAAO,EAAE,MAAM,KAAK,CAAC;AAChD,OAAO,EACL,WAAW,EACX,kBAAkB,EAClB,cAAc,GACf,MAAM,iBAAiB,CAAC;AAEzB,OAAO,EAAE,kBAAkB,EAAE,MAAM,+BAA+B,CAAC;AAEnE,OAAO,EAAE,mBAAmB,EAAE,MAAM,oBAAoB,CAAC;AAQzD,MAAM,CAAC,MAAM,kBAAkB,GAAkC,MAAM,CACrE,gBAAgB,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,EAAE,CACvC,CAAC;AAEF;;GAEG;AACH,MAAM,CAAC,MAAM,iBAAiB,GAAG,GAAS,EAAE;IAC1C,MAAM,WAAW,GAAG,kBAAkB,EAA8B,CAAC;IACrE,MAAM,WAAW,GAAG,kBAAkB,EAAE,CAAC;IACzC,MAAM,IAAI,GAAG,WAAW,EAAE,CAAC;IAC3B,MAAM,WAAW,GAAG,cAAc,EAAE,CAAC;IAErC,oDAAoD;IACpD,MAAM,aAAa,GAAG,QAAQ,CAAC,GAAG,EAAE,CAClC,WAAW,CAAC,KAAK,CAAC,IAAI;QACpB,CAAC,CAAC,KAAK;QACP,CAAC,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,IAAI,WAAW,CAAC,KAAK,CAAC,OAAO,IAAI,WAAW,CAC1E,CAAC;IACF,MAAM,WAAW,GAAG,QAAQ,CAC1B,GAAG,EAAE,CAAC,WAAW,CAAC,KAAK,CAAC,WAAW,IAAI,WAAW,CAAC,KAAK,CAAC,WAAW,IAAI,CAAC,CAC1E,CAAC;IAEF,MAAM,YAAY,GAAG,mBAAmB,CACtC,GAAG,EAAE,CAAC;QACJ,aAAa,CAAC,KAAK;QACnB,WAAW,CAAC,KAAK;QACjB,IAAI,CAAC,KAAK,CAAC,IAAI;QACf,gBAAgB,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI;KAC7C,EACD,GAAG,EAAE,CACH,mBAAmB,CAAC;QAClB,MAAM,EAAE,aAAa,CAAC,KAAK;QAC3B,WAAW,EAAE,WAAW,CAAC,KAAK;QAC9B,IAAI,EAAE,IAAI,CAAC,KAAK;QAChB,WAAW,EAAE,WAAW,CAAC,KAAK;KAC/B,CAAC,CACL,CAAC;IAEF,OAAO,CAAC,kBAAkB,EAAE,YAAY,CAAC,CAAC;AAC5C,CAAC,CAAC;AAEF;;GAEG;AACH,MAAM,CAAC,MAAM,eAAe,GAAG,GAAoB,EAAE;IACnD,MAAM,YAAY,GAAG,MAAM,CAAC,kBAAkB,CAAC,CAAC;IAEhD,IAAI,CAAC,YAAY;QACf,MAAM,IAAI,KAAK,CAAC,+CAA+C,CAAC,CAAC;IAEnE,OAAO,YAAY,CAAC;AACtB,CAAC,CAAC","sourcesContent":["import { computedWithControl } from \"@vueuse/core\";\nimport type { ComputedRef, InjectionKey } from \"vue\";\nimport { computed, inject, provide } from \"vue\";\nimport {\n  usePageData,\n  usePageFrontmatter,\n  useRouteLocale,\n} from \"vuepress/client\";\n\nimport { useThemeLocaleData } from \"@theme-hope/composables/index\";\n\nimport { resolveSidebarItems } from \"./resolveConfig.js\";\nimport type { ThemeNormalPageFrontmatter } from \"../../../../shared/index.js\";\nimport type { ResolvedSidebarItem } from \"../utils/index.js\";\n\ndeclare const __VUEPRESS_DEV__: boolean;\n\nexport type SidebarItemsRef = ComputedRef<ResolvedSidebarItem[]>;\n\nexport const sidebarItemsSymbol: InjectionKey<SidebarItemsRef> = Symbol(\n  __VUEPRESS_DEV__ ? \"sidebarItems\" : \"\",\n);\n\n/**\n * Create sidebar items ref and provide as global computed in setup\n */\nexport const setupSidebarItems = (): void => {\n  const frontmatter = usePageFrontmatter<ThemeNormalPageFrontmatter>();\n  const themeLocale = useThemeLocaleData();\n  const page = usePageData();\n  const routeLocale = useRouteLocale();\n\n  // Get sidebar config from frontmatter > themeConfig\n  const sidebarConfig = computed(() =>\n    frontmatter.value.home\n      ? false\n      : frontmatter.value.sidebar ?? themeLocale.value.sidebar ?? \"structure\",\n  );\n  const headerDepth = computed(\n    () => frontmatter.value.headerDepth ?? themeLocale.value.headerDepth ?? 2,\n  );\n\n  const sidebarItems = computedWithControl(\n    () => [\n      sidebarConfig.value,\n      headerDepth.value,\n      page.value.path,\n      __VUEPRESS_DEV__ ? page.value.headers : null,\n    ],\n    () =>\n      resolveSidebarItems({\n        config: sidebarConfig.value,\n        routeLocale: routeLocale.value,\n        page: page.value,\n        headerDepth: headerDepth.value,\n      }),\n  );\n\n  provide(sidebarItemsSymbol, sidebarItems);\n};\n\n/**\n * Inject sidebar items global computed\n */\nexport const useSidebarItems = (): SidebarItemsRef => {\n  const sidebarItems = inject(sidebarItemsSymbol);\n\n  if (!sidebarItems)\n    throw new Error(\"useSidebarItems() is called without provider.\");\n\n  return sidebarItems;\n};\n"]}