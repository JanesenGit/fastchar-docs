const d=(i,o)=>{i.attrs=(i.attrs||[]).filter(([r])=>r!==o)},u=i=>{const o=i.attrs?.find(([r])=>r==="title")?.[1];return o?(d(i,"title"),o):i.content},k=(i,o={})=>{const r=n=>{for(let t=1,{length:c}=n.tokens;t<c-1;t++){const e=n.tokens[t];if(e.type!=="inline"||!e.children||e.children.length!==1&&e.children.length!==3||e.children.length===1&&e.children[0].type!=="image")continue;if(e.children.length===3){const[g,a,f]=e.children;if(g.type!=="link_open"||a.type!=="image"||f.type!=="link_close")continue}if(t!==0&&n.tokens[t-1].type!=="paragraph_open"||t!==c-1&&n.tokens[t+1].type!=="paragraph_close")continue;const l=n.tokens[t-1];l.type="figure_open",l.tag="figure",n.tokens[t+1].type="figure_close",n.tokens[t+1].tag="figure";const s=e.children.length===1?e.children[0]:e.children[1],h=u(s),[p]=i.parseInline(h,n.env);e.children.push(new n.Token("figcaption_open","figcaption",1)),e.children.push(...p.children||[]),e.children.push(new n.Token("figcaption_close","figcaption",-1)),o.focusable!==!1&&s.attrPush(["tabindex","0"])}};i.core.ruler.before("linkify","figure",r)};export{k as figure};
//# sourceMappingURL=index.mjs.map
